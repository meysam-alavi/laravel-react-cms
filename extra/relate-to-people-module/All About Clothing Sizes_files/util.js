function generateWebPage(e){return scriptMessage('<div class="alert alert-warning margin-bottom-md">PRODUCT IS GENERATING. JUST A MOMENT....</div>'),$.ajax({data:{objid:e,format:"json"},method:"POST",url:"/cgi-bin/admin_generate.cgi",success:function(e){setTimeout(showPageGenerateStatus(e,12),2e3)}}),!1}function showPageGenerateStatus(e,t){var i=t;console.log("Beginning iteration #"+i),$.get("/cgi-bin/delayed_jobs.pl",{id:e.id},function(t){if(t&&i>0)if(console.log("Job Array found and there are "+(i-1)+" chances remaining."),0==("complete"==(s=t).status?1:0)){scriptMessage('<div class="alert alert-warning margin-bottom-md">GENERATE IN QUEUE: Job ID for '+s.objid+" is "+s.id+". Status is <strong>"+s.status+"</strong>. "+(i-1)+' updates remaining.<div><strong>Updating status in <span id="pgcdt">10</span>...</strong></div><progress value="0" max="10" id="progressBar"></progress></div></div>'),console.log(i+": GENERATE IN QUEUE: Job ID for "+s.objid+" is "+s.id+". Status is "+s.status+"."),--i,setTimeout(function(){showPageGenerateStatus(e,i)},1e4);var a=10,n=setInterval(function(){document.getElementById("progressBar").value=10- --a,document.getElementById("pgcdt").innerHTML=a,a<=0&&clearInterval(n)},1e3)}else{scriptMessage('<div class="alert alert-success margin-bottom-md"><div>Job ID for '+s.objid+" was "+s.id+". Page generation is now <strong>"+s.status+'</strong>.<div><strong>Page will refresh in <span id="pgcdt">10</span>...</strong></div><progress value="0" max="10" id="progressBar"></progress></div></div>'),setTimeout(window.location.reload.bind(window.location),1e4);a=10,n=setInterval(function(){document.getElementById("progressBar").value=10- --a,document.getElementById("pgcdt").innerHTML=a,a<=0&&clearInterval(n)},1e3)}else if(!t&&i>0){scriptMessage('<div class="alert alert-danger margin-bottom-md">PRODUCT ID NOT FOUND IN QUEUE. CHECKING AGAIN IN <span id="pgcdt">10</span> SECONDS...</div>'),--i,setTimeout(function(){showPageGenerateStatus(e,i)},1e4);a=10,n=setInterval(function(){document.getElementById("pgcdt").innerHTML=a,a<=0&&clearInterval(n)},1e3)}else if(t&&i<=0){var s;scriptMessage('<div class="alert alert-info margin-bottom-md">This page seems to be taking longer than usual to generate. Give it a bit and then refresh the page.<br /><br />Job ID for '+(s=t).objid+" is "+s.id+". Status is <strong>"+s.status+"</strong>.</div>")}else scriptMessage('<div class="alert alert-danger margin-bottom-md">PRODUCT ID NOT FOUND IN QUEUE. SOMETHING MUST HAVE GONE WRONG! TRY GENERATING AGAIN...MAYBE?<br /><br />.....if that doesn\'t work, tell Alex about it or something, I guess.</div>')})}function Querystring(e){if(this.params=new Object,this.get=Querystring_get,null==e&&(e=location.search.substring(1,location.search.length)),0!=e.length)for(var t=(e=e.replace(/\+/g," ")).split("&"),i=0;i<t.length;i++){var a,n=t[i].split("="),s=unescape(n[0]);a=2==n.length?unescape(n[1]):s,this.params[s]=a}}function Querystring_get(e,t){null==t&&(t=null);var i=this.params[e];return null==i&&(i=t),i}var debugtxt,basehref="",pageData=new Object,msgPointer=0,msgArray=["shop_AU"];function getSelectVal(e){var t=e.selectedIndex;return e.options[t].value}function setSelectVal(e,t){var i,a=e.options.length,n=!1;for(i=0;i<a;i++)e.options[i].value==t&&(e.options[i].selected=!0,n=!0);return n}function getRadioVal(e){var t,i="",a=e.length;if(a>1)for(t=0;t<a;t++){var n=e[t];1==n.checked&&(i=n.value)}else 1==e[0].checked&&(i=n.value);return i}function setRadioVal(e,t){$("input[name="+e[0].name+"][value='"+t+"']").attr("checked","checked")}function pluralize(e){return"1"==(e=e.toString().toLowerCase())||"one"==e?"":"s"}function fillTodaysDate(e){var t=new Date,i=(t.getYear()<1e3?t.getYear()+1900:t.getYear())+"-"+(t.getMonth()+1)+"-"+t.getDate();return e.value=i,!1}function fillCurrentTime(e){var t=new Date,i=t.getHours()+":"+t.getMinutes();return e.value=i,!1}function shortDate(e){return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()}function schemaDate(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}function shortUNIXDate(e){var t=parseInt(e),i=new Date;return i.setTime(1e3*t),i.getMonth()+"/"+i.getDay()+"/"+i.getFullYear()}function fillFilename(e,t){var i=e.lastIndexOf("/");i<1&&(i=e.lastIndexOf("\\")),i<1&&(i=e.lastIndexOf(":"));var a=e.substring(i+1,e.length);""!=a&&(t.value=a)}function writeWindow(e,t,i,a,n){return sWindow=window.open("",e,a),sWindow.document.open(),sWindow.document.write(i),sWindow.document.close(),n||t.focus(),n&&t.blur(),sWindow}function relocateOpener(e,t){return e.document.location.href=t,e.focus(),!1}function relocDisplayFrame(e){return parent.frames.display?parent.frames.display.document.location.href=e:document.location.href=e,!1}function relocate(e,t){var i="",a=e.elements[t],n=a.selectedIndex,s=a.options[n].value;return i+=s,!!s&&(document.location.href=basehref+i,!0)}function popWindow(e,t,i,a){var n,s;n=a||"width=740,height=500,scrollbars=yes,menubar=no,location=no,status=yes,resizable",s=e||"Popup Window";window.open(i,s,n);return!1}function popSendEmail(e){var t="mailto:"+e;return document.location.href=t,!1}function dataPop(e,t,i){var a,n="top=0,left=0,screenX=0,screenY=0,fullscreen=yes,scrollbars=no,menubar=0,location=0,status=0,width="+screen.width+",height="+screen.height;a=i||n,window.open(t,"CustomerDataPop",a).opener=this.window}function fixDecimals(e){var t=e;return t=oldFixDecimals(t)}function oldFixDecimals(e){var t=e;0==t&&(t="0.00"),t*=100,t+=.5,t=parseInt(t);var i=(t/=100).toString(),a=i.indexOf(".");return-1==a?i+=".00":a==i.length-2&&(i+="0"),t}function roundAccuracy(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i}function confirmWindowClose(e){var t=!0,i="Are you sure you want to close this window?";return""!=e&&(i=e),(t=confirm(i))&&(window.top==window?window.close():(t=confirm("This window is part of a frameset, Are you sure you want to close the whole frameset?  (cancel to send ONLY THIS FRAME to a blank page)"))?top.window.close():document.location.href="/html/eng/man/blank.html"),t}function closeWindow(){return window.top==window?window.close():(retval=confirm("This window is part of a frameset, Are you sure you want to close the whole frameset?  (cancel to send ONLY THIS FRAME to a blank page)"),retval?top.window.close():document.location.href="/html/eng/man/blank.html"),retval}function dumpDebug(){var e,t="";for(e in document)t+=e+"="+document.i+"<br>\n";writeWindow("theWindow",this.window,t)}function toggleCanvas(e,t){var i=document.getElementById("canvas"+e);if(1==t){var a=document.getElementById("source"+e);i.innerHTML=a.innerHTML}else i.innerHTML="";return!1}function showInlineMessage(e,t){var i=e+"Source",a=t||"inlineMessageCanvas",n='<div align="center"><a href="#" onClick="return showInlineMessage(\'blank\', \''+a+'\');" style="font-size:10px;">Hide This Message</a></div>',s=document.getElementById(a),r=document.getElementById(i);return s.innerHTML="blank"==e?"":r.innerHTML+n,!1}function getCookie(e){var t=document.cookie,i=e+"=",a=t.indexOf("; "+i);if(-1==a){if(0!=(a=t.indexOf(i)))return null}else a+=2;var n=document.cookie.indexOf(";",a);return-1==n&&(n=t.length),unescape(t.substring(a+i.length,n))}function pricePerUnit(e,t,i){i=i;var a=(e=parseFloat(e))/(t=parseFloat(t));return(a=a.toFixed(2))+"/"+i}function locateElement(e){var t=elemtop=0;if(e.offsetParent){do{t+=e.offsetLeft,elemtop+=e.offsetTop}while(e=e.offsetParent);return[t,elemtop]}}function showTopMessage(e){if(null==getCookie("msgDismissed")){var t=document.getElementById("messageSpace"),i="";i+="<div id=\"oneTimeMsg\" class=\"one_time_msg col-md-12 hidden-xs hidden-sm\" onClick=\"_gaq.push(['_trackEvent', 'One Time Message', 'Click', '"+e+"'])\">",i+=createTopMessageHTML(e),i+="</div>",t.innerHTML=i}}function createTopMessageHTML(e){var t="",i=new Array,a=new Array,n=new Array;return i.giftAd=imageserver+"/images/public/notification/free_gift.png",a.giftAd="/freegift",n.giftAd="Free gift with your first order",i.shop_AU=imageserver+"/images/public/notification/shop_AU.png",a.shop_AU="/information/shipping.html?content=intl",n.shop_AU="Shipping information for our Australian customers",i.shop_CA=imageserver+"/images/public/notification/shop_CA.png",a.shop_CA="/information/shipping.html?content=intl",n.shop_CA="Shipping information for our Canadian customers",i.shop_UK=imageserver+"/images/public/notification/shop_UK.png",a.shop_UK="/information/shipping.html?content=intl",n.shop_UK="Shipping information for our United Kingdom customers",i.shop_NZ=imageserver+"/images/public/notification/shop_NZ.png",a.shop_NZ="/information/shipping.html?content=intl",n.shop_NZ="Shipping information for our New Zealand customers",t+='<a href="'+a[e]+'">',t+='<img class="img-responsive" src="'+i[e]+'" alt="'+n[e]+'" /></a>',t+='<a class="x_dismiss right" href="javascript:dismissTopMessage(\''+e+'\')" title="Dismiss this note" alt="Dismiss this note">X</a>'}function replaceContact(e){var t=imageserver+"/images/eng/homepage/home_service_mid_"+e+".png";$("#callUs").attr("src",t)}function dismissTopMessage(e){var t=document.getElementById("messageSpace"),i=new Date,a=new Date;t.innerHTML="",i.setDate(i.getDate()+3e3),a.setDate(a.getDate()+1),document.cookie=e+"=closed; path=/; expires="+i.toGMTString(),document.cookie="msgDismissed=dismissed; path=/; expires="+i.toGMTString()}function getXMLHttpRequest(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)for(var e=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(e){}return null}function findBootstrapEnvironment(){var e=["xs","sm","md","lg"],t=$("<div>");t.appendTo($("body"));for(var i=e.length-1;i>=0;i--){var a=e[i];if(t.addClass("hidden-"+a),t.is(":hidden"))return t.remove(),a}}function sendAjaxPOST(e,t,i){var a=getXMLHttpRequest();a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&a.responseText&&i(a.responseText)},a.send(t)}function sendAjaxGET(e,t){var i=getXMLHttpRequest();i.open("GET",e,!0),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&i.responseText&&t(i.responseText)},i.send("")}function sendAjaxGETXML(e,t){var i=getXMLHttpRequest();i.open("GET",e,!0),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&i.responseText&&t(i.responseXML)},i.send("")}function sendAjaxXML(e,t,i){var a=getXMLHttpRequest();a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&a.responseXML&&i(a.responseXML)},a.send(t)}function scriptMessage(e,t){$("#scriptMessage").html(e),$("#scriptMessage").show(),parseInt(t)>0&&$("#scriptMessage").fadeOut(parseInt(t))}function selectRandomComment(){if(document.getElementById("randomBlock")){var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="/cgi-bin/customercomments.pl?jsonp=parseCustomerCommentJSON",e.appendChild(t)}}function getCustomerComment(e){var t=0,i=new Array;new Array;if(document.getElementById("randomBlock")&&e){t=(i=e.getElementsByTagName("item")).length;var a="/xml/customercomments/"+i[Math.round(t*Math.random())].getAttribute("id")+".xml",n='<div align="left" valign="middle" style="color:#FFFDC2;;">'+a+"</div>";document.getElementById("randomBlock").innerHTML=n,sendAjaxGETXML(a,parseCustomerCommentXML);n='<div align="left" valign="middle" style="color:#FFFDC2;;">'+a+"</div>";document.getElementById("randomBlock").innerHTML=n}}function parseCustomerCommentXML(e){var t=new Object,i=e.getElementsByTagName("item")[0];t.firstname=i.getAttribute("firstname"),t.lastname=i.getAttribute("lastname"),t.cdate=i.getAttribute("cdate"),"Microsoft Internet Explorer"==browserName?t.comments=i.childNodes[0].childNodes[0].text:t.comments=i.childNodes[0].childNodes[0].nodeValue,showCustomerComment(t)}function parseCustomerCommentJSON(JSONData){var theComment=eval(JSONData);showCustomerComment(theComment),customerCommentJSONActive=!0}function showCustomerComment(e){var t,i='"'+e.comments+'"',a="",n=new Date;n.setTime(1e3*e.cdate),e.firstname&&(a+=e.firstname+"&nbsp;"),e.lastname&&(a+=e.lastname.substr(0,1)),""==a&&(a="Anonymous"),t="<i>-"+a+'</i><br /><span class="comment-small">'+n.toDateString()+"</span>",$("#randomBlock").html(i),$("#randomBlockCred").html(t)}function sendAjaxGETXML(e,t){var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");i.open("GET",e,!0);i.onreadystatechange=function(){4==i.readyState&&200==i.status&&i.responseText&&t(i.responseXML)},i.send("")}function getXMLDataURL(e){return"/xml/products/"+e.substring(e.length-4,e.length-3)+"/"+e+".xml"}function showKitContents(e){var t="http://"+sslServer+sslDomain+getXMLDataURL(e);sendAjaxGETXML(t,displayKitContents)}function displayKitContents(xmlData){var productData=parseProductData(xmlData.getElementsByTagName("productdata")[0]),canvas=document.getElementById("canvasKitContents"+productData.objid);try{canvas.innerHTML="Kit Contents:<br/>"+getKitContentsHTML(eval("("+productData.kitconfig+")"))}catch(e){}}function getKitContentsHTML(e){var t,i="";for(t in e){var a=e[t];i+="<div>"+a.quantity+" @ ",i+=a.title,i+="</div>"}return i}function parseProductData(e){var t={},i=0;if(e.attributes){var a=e.attributes;for(i=0;i<a.length;i++)t[a.item(i).name]=a.item(i).value}var n=0;if(e.childNodes)for(n=0;n<e.childNodes.length;n++){var s=e.childNodes[n],r=s.nodeName;if("images"==r||"thumbs"==r||"promoimgs"==r||"linkages"==r||"variants"==r){t[r]=new Array;var o=0;for(o=0;o<s.childNodes.length;o++){var l=s.childNodes[o];if(l.attributes){a=l.attributes;for(i=0;i<a.length;i++){var c={};c[a.item(i).name]=a.item(i).value,t[r].push(c)}}}}else{var d=getNodeText(e.childNodes[n]);d&&(t[r]=d)}}return t}function getNodeText(e){return"Microsoft Internet Explorer"==browserName?e.text:e.textContent}function setupHexColorChips(){$("#resize_chips").click(function(){$(".rgbchip").hasClass("rgblarge")?($(".rgbchip").removeClass("rgblarge"),$("#resize_chips").html("Bigger Colorchips&nbsp;[+]")):($(".rgbchip").addClass("rgblarge"),$("#resize_chips").html("Smaller Colorchips&nbsp;[-]"))})}function initTinyMCE(){tinymce.init({selector:"textarea.mceEditor",resize:"both",browser_spellcheck:!0,theme:"modern",skin:"light",content_css:"/css/style.css",convert_urls:!1,width:750,height:200,plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking save table contextmenu directionality","emoticons template paste textcolor colorpicker textpattern"],toolbar1:"undo redo | print preview | bullist numlist | link image media | formatselect styleselect",image_advtab:!0,paste_as_text:!0,font_formats:"Arial=arial,helvetica,sans-serif;",style_formats:[{title:"Bold",inline:"b"},{title:"Important",inline:"strong"},{title:"Italic",inline:"i"},{title:"Emphatic",inline:"em"},{title:"Deleted",inline:"del"},{title:"Inserted",inline:"ins"},{title:"Red text",inline:"span",classes:"redText"},{title:"Left Justify",block:"p",classes:"alignLeft"},{title:"Right Justify",block:"p",classes:"alignRight"},{title:"Center Justify",block:"p",classes:"alignCenter"},{title:"Brief Description",block:"p",classes:"brief"},{title:"Use For/Use On",block:"p",classes:"usage"}]}),tinymce.init({selector:"textarea.mceEditorBasic",resize:"both",browser_spellcheck:!0,theme:"modern",skin:"light",content_css:"/css/style.css",convert_urls:!1,width:750,height:100,plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking save table contextmenu directionality","emoticons template paste textcolor colorpicker textpattern"],toolbar1:"undo redo | print preview | bullist numlist | link image media | formatselect styleselect",image_advtab:!0,paste_as_text:!0,font_formats:"Arial=arial,helvetica,sans-serif;",style_formats:[{title:"Bold",inline:"b"},{title:"Important",inline:"strong"},{title:"Italic",inline:"i"},{title:"Emphatic",inline:"em"},{title:"Deleted",inline:"del"},{title:"Inserted",inline:"ins"},{title:"Red text",inline:"span",classes:"redText"},{title:"Left Justify",block:"p",classes:"alignLeft"},{title:"Right Justify",block:"p",classes:"alignRight"},{title:"Center Justify",block:"p",classes:"alignCenter"},{title:"Brief Description",block:"p",classes:"brief"},{title:"Use For/Use On",block:"p",classes:"usage"}]})}function showHide(e,t){document.getElementById&&("none"==(e=document.getElementById(e)).style.display?(e.style.display="inline",document.getElementById(t).setAttribute("class","share_button_fxd")):(e.style.display="none",document.getElementById(t).setAttribute("class","share_button")))}function geolocationMsg(){return showTopMessage("giftAd"),!1}function fixProductDetailsHeight(){$('[id^="pricetable_"] tr').each(function(){var e="",t="";$(this).height()>120&&(t=$(this).attr("id").replace("offer_","content_"),$(this).find("td").each(function(){e=$(this).html(),$(this).html('<div id="'+t+'" class="collapsed-element collapse-height">'+e+"</div>").click(function(){120==$("#"+t).height()?(console.log("Height is: "+$("#"+t).height()+" ... expanding..."),$('[id^="content_"].collapse-height').removeClass("collapse-height",200).addClass("expanded-height"),$(".more-less").html('<span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span> That\'s Too Much <span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span>')):(console.log("Height is: "+$("#"+t).height()+" ... collapsing..."),$('[id^="content_"].expanded-height').removeClass("expanded-height").addClass("collapse-height",200),$(".more-less").html('<span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span> See More <span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span>'));var e=document.getElementById(t);setTimeout(function(){e.scrollIntoView({block:"start",behavior:"smooth"})},200)})}),$('<tr class="no-table-hover"><td colspan="100%" class="text-center text-muted small bold collapse-toggle"><div class="more-less"><span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span> See More <span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span></div></td></tr>').insertAfter(this).click(function(){120==$("#"+t).height()?(console.log("Height is: "+$("#"+t).height()+" ... expanding..."),$('[id^="content_"].collapse-height').removeClass("collapse-height",200).addClass("expanded-height"),$(".more-less").html('<span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span> That\'s Too Much <span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span><span class="glyphicon glyphicon-menu-up"></span>')):(console.log("Height is: "+$("#"+t).height()+" ... collapsing..."),$('[id^="content_"].expanded-height').removeClass("expanded-height").addClass("collapse-height",200),$(".more-less").html('<span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span> See More <span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span><span class="glyphicon glyphicon-menu-down"></span>'));var e=document.getElementById(t);setTimeout(function(){e.scrollIntoView({block:"start",behavior:"smooth"})},200)}))})}function getMenuData(){$.getJSON("/json/menu.js",function(e){createMenu(e)})}function createMenu(e){for(i=0;i<$('[id^="menu"]').length;i++)for(j=1;j<=4;j++){$($('[id^="menu"]')[i]).find(".col"+j).html("");var t=Object.keys(e[$('[id^="menu"]')[i].id].cols["col"+j].linksdown).length,a="";for(k=1;k<=t;k++){var n=e[$('[id^="menu"]')[i].id].cols["col"+j].linksdown[k];j<4?a=n.listClass?'<li class="subCat '+n.listClass+'"><a href="'+n.url+'" class="'+n.class+'">'+n.title+"</a></li>":'<li class="subCat"><a href="'+n.url+'" class="'+n.class+'">'+n.title+"</a></li>":(a='<div class="row cell180mmad4"><div class="col-xs-12 col-sm-12 col-md-12"><div class="font-size-md bold">',a+='<a class="s_link" href="'+n.url+'">'+n.title+"</a>",a+="</div>",a+='<a href="'+n.url+'" class="noline">',a+='<img class="img-responsive promoimage_mmad v_space" src="https://dharma-www.s3.amazonaws.com'+n.img+'" alt="'+n.title+'"></a>',Number(n.numReviews)>0&&(a+='<div class="starrating"><img src="https://dharma-www.s3.amazonaws.com'+n.rating+'" alt="'+n.numReviews+' Reviews"><br /><a class="s_link" href="'+n.url+'#reviews">('+n.numReviews+"&nbsp;Review"+pluralize(Number(n.numReviews))+")</a></div>"),a+='<div class="lowprice bold">Get it for '+n.price+"</div>",a+="</div></div>"),$($('[id^="menu"]')[i]).find(".col"+j).append(a)}}$("#mgMenu").hoverIntent({over:displayMenu,out:hideMenu,timeout:350,interval:250,selector:".ddMenu"})}function getOldMenuData(){$.getJSON("/json/megamenu.js",function(e){createMenu(e)})}function createOldMenu(e){for(var t in e)if(e.hasOwnProperty(t)){for(var i in e[t])if(e[t].hasOwnProperty(i)){if("url"==i||"category"==i||"descript"==i)continue;var a=e[t][i];for(var n in a)if(a.hasOwnProperty(n)){var s=a[n].title,r=a[n].cellstyle.split("_")[3],o=a[n].url,l=a[n].column_number,c="";if("4"==l)continue;c+='<li class="subCat',c+="subtitle"==r?" subCatTopSpace":"",c+='"><a href="',c+=o,c+='" class="',c+="subcategory"==r?"subCatDDLnk":"subCatLnk",c+='">',c+=s,c+="</a></li>",$(".col"+l+".menu"+e[t].category+"Col").append(c)}}""!=e[t].descript&&$(".col4.menu"+e[t].category+"Col").html(e[t].descript)}$("#mgMenu").hoverIntent({over:displayMenu,out:hideMenu,timeout:350,interval:250,selector:".ddMenu"})}function displayMenu(){var e=$(this).attr("id"),t=$(this).offset(),i=$("#menuDyes").offset().left;$("."+e+"Col").css("marginLeft","-="+(t.left-i)+"px"),$("."+e+"Col").slideDown(200)}function hideMenu(){var e=$(this).attr("id"),t=$(this).offset(),i=$("#menuDyes").offset().left;$("."+e+"Col").fadeOut(200),setTimeout(function(){$("."+e+"Col").css("marginLeft","+="+(t.left-i)+"px")},400)}function getHeaderPromoData(){$.getJSON("/json/headerPromoData.js",function(e){randomizeHeaderPromo(e)})}function randomizeHeaderPromo(e){var t=e[0].items.length-1,i=Math.floor(Math.random()*(t-0+1)+0);for(var a in e)if(e.hasOwnProperty(a))for(var n in e[a])if(e[a].hasOwnProperty(n)){var s="/"+e[a][n][i].url,r=e[a][n][i].stocknum.toLowerCase(),o=imageserver+"/images/eng/homepage/"+r+"_header_promo.jpg";$("#headerPromoSpace").html('<a href="'+s+"\" onclick=\"_gaq.push(['_trackEvent', 'link', 'clicked', 'header promo #"+r+"', "+i+", 'true']);\"><img src=\""+o+'" alt="Randomized promotional block" /></a>')}}function clear_http_sid_cookie(){"http:"==location.protocol&&Cookies.remove("sid")}function assure_https(){"http:"==location.protocol&&(clear_http_sid_cookie(),window.location.href="https://"+location.hostname+location.pathname+location.search)}function assure_www(){"dharmatrading.com"==location.hostname&&(window.location.href="https://www."+location.hostname+location.pathname+location.search)}$(document).ready(function(){$(".dropdown-toggle").click(function(e){$(".navbar-nav li.open a")[0]!=$(e.target)[0]&&$(".navbar-nav li.open a b")[0]!=$(e.target)[0]&&($(".navbar-nav li.open a.dropdown-toggle").next(".dropdown-menu").slideToggle(50),$(".navbar-nav li.open a.dropdown-toggle b.glyphicon").toggleClass("glyphicon-minus glyphicon-plus"),$(".navbar-nav li.open").removeClass("open")),$(this).next(".dropdown-menu").slideToggle(50),$(this).children("b.glyphicon").toggleClass("glyphicon-plus glyphicon-minus")})}),$.extend($.expr[":"],{containsExact:$.expr.createPseudo?$.expr.createPseudo(function(e){return function(t){return $.trim(t.innerHTML.toLowerCase())===e.toLowerCase()}}):function(e,t,i){return $.trim(e.innerHTML.toLowerCase())===i[3].toLowerCase()},containsExactCase:$.expr.createPseudo?$.expr.createPseudo(function(e){return function(t){return $.trim(t.innerHTML)===e}}):function(e,t,i){return $.trim(e.innerHTML)===i[3]},containsRegex:$.expr.createPseudo?$.expr.createPseudo(function(e){var t=/^\/((?:\\\/|[^\/])+)\/([mig]{0,3})$/.exec(e);return function(e){return!!t&&RegExp(t[1],t[2]).test($.trim(e.innerHTML))}}):function(e,t,i){var a=/^\/((?:\\\/|[^\/])+)\/([mig]{0,3})$/.exec(i[3]);return!!a&&RegExp(a[1],a[2]).test($.trim(e.innerHTML))}});var navGroups=new Array,switchedBack=0,theTimeout,numImages,preloadedImages=new Array,preloadFlag=!1;function init(){numImages=picArray.length,preloadImages(),numImages>0&&""!=picArray[1].src&&"clear.gif"!=picArray[1].src&&showPic(1),0==customerCommentJSONActive&&(selectRandomComment(),$(".comment-outer").hide())}function drawLnav(){var e="",t=navInclude.indexOf(".html")?navInclude.substring(0,navInclude.indexOf(".html")):navInclude,i=(new Querystring).get("lnav");if(null!=i&&(t=i.indexOf(".html")?i.substring(0,i.indexOf(".html")):i),null!=t&&" "!=t&&"default"!=t||(t="home"),navGroup[t]){var a=navGroup[t].items.length;if(a>0){e+='<div class="col-md-12 navbox">';for(var n=0;n<a;n++)e+='<div class="'+navGroup[t].items[n].styleclass+'area">',e+='<a href="'+navGroup[t].items[n].url+'" class="'+navGroup[t].items[n].styleclass+'link">',e+=navGroup[t].items[n].title,e+="</a>",e+="</div>";e+="</div>"}}else console.log("navGroup not found for "+t);$("#lnavblck").html(e)}function navGroup(e){this.title=e,this.items=new Array}function preloadImages(){if(document.images){for(i=1;i<numImages-1;i++)""!=picArray[i].src&&"clear.gif"!=picArray[1].src&&(preloadedImages[i]=newImage(imageserver+"/images/eng/products/image/"+picArray[i].src));preloadFlag=!0}}function newImage(e){if(document.images)return rslt=new Image,rslt.src=e,rslt}function navItem(e,t,i){this.title=e,this.url=t,this.styleclass=i}function picObject(e,t,i,a,n){this.src=e,this.width=t,this.height=i,this.alt=a,this.fullsize=n}function iconObject(e,t,i,a,n,s){this.src=e,this.alt=t,this.url=i,this.title=a,this.subtitle=n,this.descript=s}function videoObject(e,t,i){e.split("?v=")[1]||e.split(".be/")[1]||e.split(".com/v/")[1]?(this.videoGID=e.split("?v=")[1]?e.split("?v=")[1]:e.split(".be/")[1]?e.split(".be/")[1]:e.split(".com/v/")[1],this.videoURL="https://www.youtube.com/watch?v="+this.videoGID,this.videothumb=this.videoGID&&""!=this.videoGID?"https://i.ytimg.com/vi/"+this.videoGID+"/mqdefault.jpg":"/images/eng/general/clear.gif"):e.split("vimeo.com/")[1]?(this.videoGID=e.split("vimeo.com/")[1],this.videoURL=e,this.videothumb="/images/eng/backgrounds/vimeo-bkg.jpg"):(this.videoURL=e,this.videoGID="",this.videothumb="/images/eng/backgrounds/vimeo-bkg.jpg"),this.videotitle=t,this.videodescript=i}function showPic(e){var t="",i=picArray[e],a=imageserver+"/images/eng/products/image/"+i.src,n=imageserver+"/images/eng/products/fullsize/"+i.src;return 1==i.fullsize?(t+='<a class="fancybox-product-image" href="'+n+'" onclick="$.fancybox({ href: \''+n+"', title: '"+i.alt+"' }); return false;\">",t+='<img class="img-responsive center-block" src="'+a+'" name="picCanvas" alt="Product Photo: '+i.alt+'"/>',$('[id^="unitpr_1"] .regular-price').html()&&(t+='<div class="product-sale-tag"><img src="'+imageserver+'/images/eng/products/promoimg/sale_overlay.png" alt="This product is on sale"></div>'),t+="</a>"):(t+='<img class="img-responsive center-block" src="'+a+'" name="picCanvas" alt="Product Photo: '+i.alt+'"/>',$('[id^="unitpr_1"] .regular-price').html()&&(t+='<div class="product-sale-tag"><img src="'+imageserver+'/images/eng/products/promoimg/sale_overlay.png" alt="This product is on sale"></div>')),1==i.fullsize?$("#enlargeMessageDiv").html(i.alt+'<br />(<a class="fancybox-product-image" href="'+n+'" onclick="$.fancybox({ href: \''+n+"', title: '"+i.alt+"' }); return false;\">View Full Size</a>)"):$("#enlargeMessageDiv").html(i.alt),$("#divCanvas").html(t),!1}function popAddProductReview(){return getAddProductReviewContent("/cgi-bin/product_reviews.cgi?mode=add&objid="+objid),!1}function getAddProductReviewContent(e){$("#jqueryUIDialogSource").load(e,showAddProductReviewContent)}function showAddProductReviewContent(e){$.fancybox({content:$("#jqueryUIDialogSource"),minWidth:"50%"})}function showReviewSummary(e){var t=e;if(void 0===t&&(t=!1),1==t)if(numRatings>0){var i=getStarName(avgRating);$("#starRatingImg").attr("src",imageserver+"/images/public/ratings_stars/stars-"+i+".gif"),$("#reviewPlural").html(pluralize(numRatings))}else $("#canvasReviewSummary").html('<div class="img-thumbnail">No reviews yet. <a href="/cgi-bin/product_reviews.cgi?mode=add&objid='+objid+'" onClick="return popAddProductReview();">Be the first to review this item.</a></div><meta itemprop="ratingValue" content="5" /><meta itemprop="bestRating" content="5" /><meta itemprop="worstRating" content="1" /><meta itemprop="ratingCount" content="1" />');else if(numRatings>0){i=getStarName(avgRating);document.writeln('<div><img src=" + imageserver + "/images/public/ratings_stars/stars-'+i+'.gif" align="absmiddle" alt="'+avgRating+' star rating">&nbsp;<span itemprop="ratingValue">'+avgRating+'</span>&nbsp;(&nbsp;<a href="#reviews"><span class="count" itemprop="reviewCount">'+numRatings+"</span> review"+pluralize(numRatings)+"</a>&nbsp;)"),document.writeln("</div>"),document.writeln('<div style="margin: 4px 0px 0px 7px;"><a href="/cgi-bin/product_reviews.cgi?mode=add&objid='+objid+'" onClick="return popAddProductReview();">Click here</a> to add or update a review for this product.</div>')}else document.writeln('<div>No reviews yet. <a href="/cgi-bin/product_reviews.cgi?mode=add&objid='+objid+'" onClick="return popAddProductReview();">Be the first to review this item.</a></div>')}function getStarName(e){var t="";return e>.01&&(t="1-0"),e>1.25&&(t="1-5"),e>1.75&&(t="2-0"),e>2.25&&(t="2-5"),e>2.75&&(t="3-0"),e>3.25&&(t="3-5"),e>3.75&&(t="4-0"),e>4.25&&(t="4-5"),e>4.75&&(t="5-0"),t}function updateReviewSampleStar(e,t){var i=t.selectedIndex,a=getStarName(t.options[i].value),n=document.getElementById(e);a.length>1&&(n.src=imageserver+"/images/public/ratings_stars/stars-"+a+".gif")}function addReview(e){var t=e.elements.productRating.selectedIndex,i=e.elements.productRating.options[t].value,a=e.elements.productReview.value,n=e.elements.objid.value;if(i>0&&a.length>0){sendAjax("/cgi-bin/catch_product_review.cgi","objid="+n+"&rating="+i+"&review="+a,catchReviews),setTimeout("updateReviewSummary()",1e3),jQuery(document).trigger("close.facebox"),document.getElementById("canvasAddReview").innerHTML="<div>Thanks for adding a review.</div>"}else{var s="";0==i&&(s+="Please choose a rating for this prduct, so we can include it in the calculation for average review.\n"),0==a.length&&(s+="Please enter a comment to help people understand this product better.\n"),alert(s)}}function catchReviews(e){document.getElementById("canvasReviews").innerHTML=e}function catchReviewSummary(e){document.getElementById("canvasReviewSummary").innerHTML=e}function sendAjax(e,t,i){var a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&a.responseText&&i(a.responseText)},a.send(t)}function sendReviewFeedback(e,t){$("div#reviewRow"+e+" img.reviewYesHelpful").fadeOut(),$("div#reviewRow"+e+" img.reviewNoHelpful").fadeOut(),$("div#reviewRow"+e+" span.label").html("Thank you for your feedback.");var i;if(sendAjax("/cgi-bin/catch_product_review_feedback.cgi","objid="+objid+"&rating="+t+"&id="+e,catchReviews),pageData.productReviewsById.length>0)pageData.productReviewsById[e].feedback_num++,1==t&&pageData.productReviewsById[e].num_helpful++,(i=document.getElementById("numHelpful"+e)).innerHTML=pageData.productReviewsById[e].num_helpful,(i=document.getElementById("numFeedback"+e)).innerHTML=pageData.productReviewsById[e].feedback_num;else{i=document.getElementById("numFeedback"+e);var a=parseInt(i.innerHTML);a++,i.innerHTML=a,i=document.getElementById("numHelpful"+e);var n=parseInt(i.innerHTML);1==t&&n++,i.innerHTML=n}}function updateReviewSummary(){sendAjax("/cgi-bin/get_product_review_summary.cgi","objid="+objid,catchReviewSummary)}pageData.productReviews=new Array,pageData.productReviewsById=new Array,pageData.productReviewsFeedback=new Array,pageData.productReviewsFeedbackById=new Array;var selectedRating=0;function showReviews(e){return selectedRating=e,0==pageData.productReviews.length?getProductReviews():sortResults("feedback_score"),!1}function getProductReviews(){var e="/cgi-bin/product_reviews.cgi?mode=xml&objid="+objid;sendAjaxGETXML(e,parseProductReviewsXMLData);var t='<div style="margin:20px;"><img src="'+imageserver+'/images/public/ajax/ajax-loader-2.gif" alt="Loading..."> Loading...</div>';document.getElementById("canvasReviewsMostHelpful").innerHTML=t}function parseProductReviewsXMLData(e){var t=e.getElementsByTagName("productreview");for(idx=0;idx<t.length;idx++)updateProductReviewObject(t[idx]);for(t=e.getElementsByTagName("productreviewfeedback"),idx=0;idx<t.length;idx++)updateProductReviewFeedbackObject(t[idx]);for(idx=0;idx<pageData.productReviews.length;idx++)""==pageData.productReviews[idx].sortval&&(pageData.productReviews[idx].sortval=pageData.productReviews[idx].title);return sortResults("feedback_score"),!1}function updateProductReviewObject(e){var t=new Object;t.id=e.getAttribute("id"),t.objid=e.getAttribute("objid"),t.custid=e.getAttribute("custid"),t.rating=e.getAttribute("rating"),t.status=e.getAttribute("status"),t.feedback_score=e.getAttribute("feedback_score"),t.feedback_total=e.getAttribute("feedback_total"),t.num_helpful=e.getAttribute("num_helpful"),t.cdate=new Date,t.cdate.setTime(1e3*e.getAttribute("cdate")),t.mdate=new Date,t.mdate.setTime(1e3*e.getAttribute("mdate"));var i=0;if(e.childNodes)for(i=0;i<e.childNodes.length;i++)"review"==e.childNodes[i].nodeName&&("Microsoft Internet Explorer"==browserName?t.review=e.childNodes[i].text:t.review=e.childNodes[i].textContent);var a=e.getAttribute("id");return pageData.productReviewsById[a]?pageData.productReviewsById[a]=t:(pageData.productReviewsById[a]=t,pageData.productReviews.push(t)),t}function sortResults(e){for(idx=0;idx<pageData.productReviews.length;idx++)pageData.productReviews[idx].sortval=pageData.productReviews[idx].feedback_score;var t=pageData.productReviews.sort(sortbySortval);t.reverse(),displayProductReviews(t)}function displayProductReviews(e){var t="",i=document.getElementById("canvasReviewsMostHelpful");for(t+=selectedRating>0?'<div class="review_header">'+selectedRating+" STAR REVIEWS</div>":'<div class="review_header">MOST HELPFUL REVIEWS</div>',t+='<div class="row no-gutter h_pad"><div class="col-sm-12"><hr class="dark mini"></hr></div></div>',idx=0;idx<e.length;idx++)0!=selectedRating&&e[idx].rating!=selectedRating||(t+=getProductReviewHTML(e[idx]));t+="</div>",i.innerHTML=t}function getProductReviewHTML(e){var t="";return t+='<div class="h_pad" itemprop="review" itemscope itemtype="http://schema.org/Review">',t+='<div class="star-summary">',t+='<img class="img-responsive pull-left" src="'+imageserver+"/images/public/ratings_stars/stars-"+e.rating+'-0.gif" alt="'+e.rating+' stars" />',t+='<div class="review-date pull-left">'+shortDate(e.cdate)+"</div>",t+='<div class="review-value" itemprop="reviewRating" itemscope itemtype="http://schema.org/Rating">',t+='<span itemprop="ratingValue">'+e.rating+"</span>",t+="</div>",t+="</div>",t+='<div class="review small" itemprop="reviewBody">'+e.review+"</div>",t+='<div id="reviewRow'+e.id+'" class="review_label">Was this review helpful?&nbsp;',t+='<img class="reviewYesHelpful" alt="Button: This review was helpful" src="'+imageserver+'/images/public/product_reviews/yes.png" onClick="sendReviewFeedback(\''+e.id+'\', 1);" value="Yes" style="cursor:pointer;"> ',t+='<img class="reviewNoHelpful" alt="Button: This review was not helpful" src="'+imageserver+'/images/public/product_reviews/no.png" onClick="sendReviewFeedback(\''+e.id+'\', 0);" value="No" style="cursor:pointer;">',t+="</div>",t+='<div class="review_num_helpful">',t+='<span id="numHelpful'+e.id+'">'+e.num_helpful+'</span> of <span id="numFeedback'+e.id+'">'+e.feedback_total+"</span> users found this review helpful.",t+="</div>",t+="</div>",t+='<div class="row no-gutter h_pad"><div class="col-sm-12"><hr class="dark"></hr></div></div>'}function sortbySortval(e,t){return e.sortval-t.sortval}var formerrorObjects=new Array,numErrors=0;function formerrorValidator(e,t,i,a){var n="";if("isNotEmpty"==i&&""==t&&(n=a||e+" cannot be left blank.",formerrorObjects[numErrors]=new formerrorObject(numErrors,e,n),numErrors++),"isNotExpired"==i&&""!=t){var s=new Date,r=t;if("cc_expyr"==e)var o=s.getFullYear()<=r?s.getFullYear()==r?1:2:0;else if("cc_expmo"==e)o=s.getMonth()<=r-1?1:0;return o}}function formerrorHandler(){var e,t="",i=!0;if(numErrors>0){for(e=0;e<numErrors;e++)t+=formerrorObjects[e].alerttext+"\n";1==numErrors?alert("There is "+numErrors+" error with your submission:\n\n"+t):alert("There are "+numErrors+" errors with your submission:\n\n"+t),i=!1}else i=!0;return i}function formerrorObject(e,t,i){this.id=e,this.fieldname=t,this.alerttext=i}var animatedcollapse={divholders:{},divgroups:{},lastactiveingroup:{},preloadimages:[],show:function(e){if("object"==typeof e)for(var t=0;t<e.length;t++)this.showhide(e[t],"show");else this.showhide(e,"show")},hide:function(e){if("object"==typeof e)for(var t=0;t<e.length;t++)this.showhide(e[t],"hide");else this.showhide(e,"hide")},toggle:function(e){"object"==typeof e&&(e=e[0]),this.showhide(e,"toggle")},addDiv:function(e,t){return this.divholders[e]={id:e,$divref:null,attrs:t},this.divholders[e].getAttr=function(e){return new RegExp(e+"=([^,]+)","i").test(this.attrs)&&0!=parseInt(RegExp.$1)?RegExp.$1:null},this.currentid=e,this},showhide:function(e,t){var i=this.divholders[e].$divref;if(this.divholders[e]&&1==i.length){var a=this.divgroups[i.attr("groupname")];i.attr("groupname")&&a.count>1&&("show"==t||"toggle"==t&&"none"==i.css("display"))?(a.lastactivedivid&&a.lastactivedivid!=e&&this.slideengine(a.lastactivedivid,"hide"),this.slideengine(e,"show"),a.lastactivedivid=e):this.slideengine(e,t)}},slideengine:function(e,t){var i=this.divholders[e].$divref,a=this.divholders[e].$togglerimage;if(this.divholders[e]&&1==i.length){var n={height:t};return i.attr("fade")&&(n.opacity=t),i.animate(n,i.attr("speed")?parseInt(i.attr("speed")):500,function(){if(a&&a.attr("src","none"==i.css("display")?a.data("srcs").closed:a.data("srcs").open),animatedcollapse.ontoggle)try{animatedcollapse.ontoggle(jQuery,i.get(0),i.css("display"))}catch(e){alert('An error exists inside your "ontoggle" function:\n\n'+e+"\n\nAborting execution of function.")}}),!1}},generatemap:function(){for(var e={},t=0;t<arguments.length;t++)null!=arguments[t][1]&&(e[arguments[t][0]]=arguments[t][1]);return e},init:function(){var e=this;jQuery(document).ready(function(t){animatedcollapse.ontoggle=animatedcollapse.ontoggle||null;var i=animatedcollapse.urlparamselect(),a=e.getCookie("acopendivids"),n=e.getCookie("acgroupswithpersist");null!=a&&(a="nada"==a?[]:a.split(",")),n=null==n||"nada"==n?[]:n.split(","),jQuery.each(e.divholders,function(){if(this.$divref=t("#"+this.id),!this.getAttr("persist")&&-1==jQuery.inArray(this.getAttr("group"),n)||null==a)s=this.getAttr("hide")?"none":null;else var s=-1!=jQuery.inArray(this.id,a)?"block":"none";if("all"==i[0]||-1!=jQuery.inArray(this.id,i)?s="block":"none"==i[0]&&(s="none"),this.$divref.css(e.generatemap(["height",this.getAttr("height")],["display",s])),this.$divref.attr(e.generatemap(["groupname",this.getAttr("group")],["fade",this.getAttr("fade")],["speed",this.getAttr("speed")])),this.getAttr("group")){var r=e.divgroups[this.getAttr("group")]||(e.divgroups[this.getAttr("group")]={});r.count=(r.count||0)+1,-1!=jQuery.inArray(this.id,i)&&(r.lastactivedivid=this.id,r.overridepersist=1),(!r.lastactivedivid&&"none"!=this.$divref.css("display")||"block"==s&&void 0===r.overridepersist)&&(r.lastactivedivid=this.id),this.$divref.css({display:"none"})}}),jQuery.each(e.divgroups,function(){this.lastactivedivid&&"none"!=i[0]&&e.divholders[this.lastactivedivid].$divref.show()}),animatedcollapse.ontoggle&&jQuery.each(e.divholders,function(){animatedcollapse.ontoggle(jQuery,this.$divref.get(0),this.$divref.css("display"))}),t("a[rel]").filter('[rel^="collapse["], [rel^="expand["], [rel^="toggle["]').each(function(){this._divids=this.getAttribute("rel").replace(/(^\w+)|(\s+)/g,"").replace(/[\[\]']/g,""),1==this.getElementsByTagName("img").length&&e.divholders[this._divids]&&(animatedcollapse.preloadimage(this.getAttribute("data-openimage"),this.getAttribute("data-closedimage")),$togglerimage=t(this).find("img").eq(0).data("srcs",{open:this.getAttribute("data-openimage"),closed:this.getAttribute("data-closedimage")}),e.divholders[this._divids].$togglerimage=t(this).find("img").eq(0),e.divholders[this._divids].$togglerimage.attr("src","none"==e.divholders[this._divids].$divref.css("display")?$togglerimage.data("srcs").closed:$togglerimage.data("srcs").open)),t(this).click(function(){var e=this.getAttribute("rel"),t=""==this._divids?[]:this._divids.split(",");if(t.length>0)return animatedcollapse[/expand/i.test(e)?"show":/collapse/i.test(e)?"hide":"toggle"](t),!1})}),t(window).bind("unload",function(){e.uninit()})})},uninit:function(){var e="",t="";jQuery.each(this.divholders,function(){"none"!=this.$divref.css("display")&&(e+=this.id+","),this.getAttr("group")&&this.getAttr("persist")&&(t+=this.getAttr("group")+",")}),e=""==e?"nada":e.replace(/,$/,""),t=""==t?"nada":t.replace(/,$/,""),this.setCookie("acopendivids",e),this.setCookie("acgroupswithpersist",t)},getCookie:function(e){var t=new RegExp(e+"=[^;]*","i");return document.cookie.match(t)?document.cookie.match(t)[0].split("=")[1]:null},setCookie:function(e,t,i){if(void 0!==i){var a=new Date;a.setDate(a.getDate()+i),document.cookie=e+"="+t+"; path=/; expires="+a.toGMTString()}else document.cookie=e+"="+t+"; path=/"},urlparamselect:function(){return window.location.search.match(/expanddiv=([\w\-_,]+)/i),""!=RegExp.$1?RegExp.$1.split(","):[]},preloadimage:function(){for(var e=this.preloadimages,t=0;t<arguments.length;t++)arguments[t]&&arguments[t].length>0&&(e[e.length]=new Image,e[e.length-1].src=arguments[t])}};function userWelcome(){document.getElementById("userWelcome").innerHTML=getWelcomeMessage()}function getWelcomeMessage(){var e=getCookie("userclass");return welcomeMessage(getCookie("firstname"),e)}function getMyAccountOptions(){var e=getCookie("userclass"),t="";return t+='<div id="acctOptions">',"admin"!=e&&"staff"!=e||(t+='<span id="adminControlClicker" style="text-align:center;"><a href="javascript:showAdminControl();"><img src="'+imageserver+'/images/eng/general/lockbox.gif" border="0" align="top" id="adminLockBoxImage" alt="Lockbox"><a></span>'),t+='<a href="'+sslPrefix+"://"+sslServer+sslDomain+"/cgi-bin/myaccount.cgi?mode=add_favorite&objid="+objid+'" target="_parent"><img src="'+imageserver+'/images/eng/buttons/AddToFavorites.gif" alt="Button: Add this item to your favorites list"></a>',t+='<a href="'+sslPrefix+"://"+sslServer+sslDomain+'/cgi-bin/myaccount.cgi" target="_parent"><img src="'+imageserver+'/images/eng/buttons/MyDharmaAccount.gif" alt="Button: Go to My Dharma Account"></a>',t+="</div>"}function getMyAccountOptions_v2(){var e=getCookie("userclass"),t=sslPrefix+"://"+sslServer+sslDomain+"/cgi-bin/myaccount.cgi",i=sslPrefix+"://"+sslServer+sslDomain+"/cgi-bin/myaccount.cgi?mode=add_favorite&objid="+objid;"admin"!=e&&"staff"!=e||($("#adminControlToggle").show().click(toggleAdminControl),$("#adminControl").html(getAdminControl_v2())),""!=e&&e&&($("#userWelcome").removeClass("col-md-10").addClass("col-md-6"),$("#userFunctions").removeClass("col-md-2").addClass("col-md-6"),$("#checkoutLink").removeClass("col-md-12").addClass("col-md-4"),$("#myAcct").show().click(function(){window.location=t}),$("#addFavorite").show().click(function(){window.location=i}))}function toggleAdminControl(){var e=getCookie("userclass");"admin"!=e&&"staff"!=e||$("#adminControl").animate({left:0==parseInt($("#adminControl").css("left"),10)?-$("#adminControl").outerWidth(!0):0},500,"easeOutExpo")}function welcomeMessage(e,t){var i="";return null==e||""==e?(i+="Welcome, Guest",i+='&nbsp;&nbsp;<br class="hidden-sm hidden-md hidden-lg" /><span class="small">(<a href="',i+=sslPrefix+"://"+sslServer+sslDomain+'/cgi-bin/myaccount.cgi?mode=login" target="_parent">sign in</a>)</span>'):(i+="Welcome, "+e,i+='&nbsp;&nbsp;<span class="small hidden-xs">(<a href="',i+=sslPrefix+"://"+sslServer+sslDomain+'/cgi-bin/myaccount.cgi?mode=signout" target="_parent" onClick="return parent.signOut();">sign out</a>)</span>'),i}function setThingAttribute(e,t,i){$.get("/cgi-bin/admin_webpage.cgi?mode=save&objid="+e+"&"+t+"="+i+"&generate_flag=Y&"+t+"_inp=1&generate_flag_inp=1")}function getAdminControl_v2(){var e=modulename||null,t=getXMLDataURL(objid),i="";return i+='<div align="left">',objid&&(i+='<input type="text" size="10" value="'+objid+'" style="font-size: 14px; margin-right: 15px;" onFocus="this.select();"  onmouseup="return false;" aria-label="Page ObjID Number" />'),i+='<a class="bluebutton button" href="https://infoserver.dharmatrading.com/cgi-bin/home.cgi?mode=feedback&department=Website&type=Problem&sampleurl='+document.location.href+'" target="_blank" ',i+="onClick=\"return popWindow(this.window, 'Feedback', this.href);\">Report A Problem</a>",pagestyle&&(i+='&nbsp;<span class="subtitle h_pad">Pagestyle: '+pagestyle+"</span>"),i+="</div>",objid&&(i+='<div class="adminControlCol left">',i+="<p>",i+='<a href="/cgi-bin/admin_webpage.cgi?mode=edit&objid='+objid+'">Edit Web Page</a>',i+="</p><p>",i+='<a href="/cgi-bin/admin_product.cgi?mode=edit&objid='+objid+'">Edit Product</a>',i+="</p><p>",i+='<a href="/cgi-bin/admin_linkage.cgi?mode=edit&objid='+objid+'">Edit Linkages</a>',i+="</p><p>",i+='<a href="/cgi-bin/admin_prices.cgi?mode=edit&objid='+objid+'">Edit Prices</a>',i+="</p><p>",i+='<a href="/cgi-bin/admin_images.cgi?mode=edit&objid='+objid+'">Edit Images</a>',i+="</p><p>",i+="<a href=\"#\" onClick=\"$('#adminControlToggle').click(); generateWebPage('"+objid+"');\">Generate Page</a>",i+="</p><p>",i+='<a href="'+t+'">XML</a>',i+="</p>"),"admin_featured"==e&&(i+="<p>",i+='<a href="/cgi-bin/admin_featured.cgi?mode=edit&id='+id+'">Edit Featured Artist</a>',i+="</p><p>",i+='<a href="/cgi-bin/admin_generate_featured.cgi?id='+id+'">Generate Featured Artist</a>',i+="</p>"),i+="</div>",i+='<div class="adminControlCol left">',i+="<p><b>Site Admin</b></p>",i+="<p>",i+='<a href="/cgi-bin/admin_webpage.cgi?mode=frames" target="_blank">WebDocs</a>',i+="</p><p>",i+='<a href="/cgi-bin/view_webpage_changelog.cgi" target="_blank">WebPage Change Log</a>',i+="</p><p>",i+='<a href="/cgi-bin/admin_featured.cgi" target="_blank">Featured Artists</a>',i+="</p><p>",i+='<a href="/cgi-bin/customerphotos.cgi" target="_blank">Customer Photos</a>',i+="</p>",i+="</div>",i+='<div class="adminControlCol left">',i+="<p><b>Site Review</b></p>",i+="<p>",i+='<a href="/cgi-bin/search.cgi?mode=log" target="_blank">Last 100 Searches</a>',i+="</p><p>",i+='<a href="/cgi-bin/search.cgi?mode=stats" target="_blank">Zero-Sum Searches</a>',i+="</p>",i+="</div>",i+='<div class="adminControlCol left">',i+="<p><b>Stats &amp; Reports</b></p>",i+="<p>",i+='<a href="'+sslPrefix+"://"+sslServer+sslDomain+'/cgi-bin/vieworders.cgi" target="_blank">View&nbsp;Online&nbsp;Orders</a>',i+="</p><p>",i+='<a href="/cgi-bin/viewstats.cgi" target="_blank">Website&nbsp;Stats</a>',i+="</p><p>",i+='<a href="https://www.google.com/analytics" target="_blank">Google Analytics</a>',i+="</p><p>",i+='<a href="/cgi-bin/payments.pl" target="_blank">Online CC Payments</a>',i+="</p><p>",i+='<a href="'+sslPrefix+"://"+sslServer+sslDomain+'/cgi-bin/paypal.pl" target="_blank">PayPal Admin.</a>',i+="</p><p>",i+='<a href="/cgi-bin/problem_reports.pl" target="_blank">Problem Reports</a>',i+="</p>",i+="</div>",i+='<div class="adminControlCol left">',i+="<p><b>System Tools</b></p>",i+="<p>",i+='<a href="https://www.dharmatrading.com/cgi-bin/mailq.cgi" target="_blank">MailQ</a>',i+="</p><p>",i+='<a href="/cgi-bin/product_reviews.cgi" target="_blank">Product Reviews</a>',i+="</p><p>",i+='<a href="/cgi-bin/admin_contacts.cgi" target="_blank">Contacts</a>',i+="</p><p>",i+='<a href="/cgi-bin/email_addresses.pl" target="_blank">Email Addresses (opt-in/out)</a>',i+="</p><p>",i+='<a href="/cgi-bin/customercomments.cgi" target="_blank">Customer Comments</a>',i+="</p><p>",i+='<a href="/cgi-bin/coupons.cgi" target="_blank">Coupons</a>',i+="</p><p>",i+='<a href="/cgi-bin/taxjar_api_log.pl" target="_blank">TaxJar API Log</a>',i+="</p><p>",i+='<a href="/cgi-bin/shippingestimator.cgi" target="_blank" onClick="return popWindow(\'ShippingEstimator\',this.window,this.href,\'width=800,height=400,resizable=yes\');">Shipping Estimator</a>',i+="</p>",i+="</div>"}function getCookie(e){var t=document.cookie,i=e+"=",a=t.indexOf("; "+i);if(-1==a){if(0!=(a=t.indexOf(i)))return null}else a+=2;var n=document.cookie.indexOf(";",a);return-1==n&&(n=t.length),unescape(t.substring(a+i.length,n))}function userWelcomeMessage(e){var t=document.getElementById("userWelcome");t&&(t.innerHTML=e)}function topMessage(e){var t=document.getElementById("topMessage");t&&(t.innerHTML=e)}function setInnerHTML(e,t){var i=document.getElementById(e);i&&(i.innerHTML=t)}function customOrderformVariant(e,t,i,a,n,s){this.textval=e,this.variantunavailable=t,this.vcode=i,this.sizes=[a],this.prices=[n],this.vspan=s,this.createTableRow=function(e){var t="";if(t+='<div class="row no-gutter" id="color-row-'+this.vcode+'">',t+='<div class="col-xs-2 col-sm-2 center-block">',t+='<div class="chip-wrapper">',t+='<div id="color-chip-'+this.vcode+'-original" class="color-chip-original"></div>',t+='<div id="color-chip-'+this.vcode+'" class="rgbchip"></div>',t+="</div>",t+="</div>",t+='<div class="hidden-xs col-sm-'+this.vspan+' colorname padding-bottom-md" name="colorname-'+this.vcode+'"><div class="small bold">'+this.textval+"</div>",t+="</div>",this.variantunavailable)t+='<div class="col-xs-7 col-sm-3 text-bold small">',t+="This color is unavailable.",t+="</div>",t+='<div class="col-xs-3 col-sm-1 text-center">',t+='<span class="glyphicon glyphicon-question-sign text-red font-size-lg" data-container="body" data-toggle="popover" data-placement="top" title="Oh No!" data-content="This color is unavailable as it contains Cerulean Blue, which is unavailable worldwide. We will be reformulating this color, using other ingredients, but that will take some time." onMouseOver="$(this).popover(\'show\')" onMouseOut="$(this).popover(\'hide\')"></span>',t+="</div>";else{for(var i in t+='<div class="col-xs-5 col-sm-2">',t+='<select class="form-control sizepulldown" name="stocknum'+this.vcode+'" data-vcode="'+this.vcode+'">',this.sizes[0])t+='<option id="option-'+this.sizes[0][i].stocknum+"-"+this.vcode+'" value="'+this.sizes[0][i].stocknum+'"',this.sizes[0][i].disabled&&(t+=' disabled="disabled"'),t+=">",t+=i+"</option>";for(var a in t+="</select>",t+='<input type="hidden" name="vcode'+this.vcode+'" value="'+this.vcode+'" /></div>',t+='<div class="col-xs-3 col-sm-1"><input type="text" class="center-block text-center small input-quant" aria-label="Quantity of'+this.textval+'" name="quant'+this.vcode+'" value="" /></div>',this.prices[0].listprice&&(t+='<div name="price-'+this.vcode+'-listprice" class="hidden-xs col-sm-1 text-center small listprice"></div>'),this.prices[0])"listprice"!=a&&(t+="1"==a?'<div name="price-'+this.vcode+"-"+a+'" class="col-xs-1 col-sm-1 text-center small"></div>':'<div name="price-'+this.vcode+"-"+a+'" class="hidden-xs col-sm-1 text-center small"></div>')}return t+="</div>",t+='<div class="row no-gutter" id="color-name-row-'+this.vcode+'">',t+='<div class="col-xs-12 hidden-sm hidden-md hidden-lg colorname padding-bottom-md" name="colorname-'+this.vcode+'">',t+='<div class="small bold">',t+=this.textval,t+="</div>",t+="</div>",t+="</div>"}}function createCustomOrderform(e){controlData=e;var t="",i=0,a=7;for(x=0;x<Object.keys(controlData).length;x++){var n=0;for(var s in controlData[x].prices)++n>i&&(a=7-(i=n))}for("page_picbrowser_custom_orderform"==pagestyle&&(t+=""),x=0;x<Object.keys(controlData).length;x++){for(var s in t+='<div class="row"><div class="col-xs-12 hidden-sm hidden-md hidden-lg margin-bottom-sm bold">'+controlData[x].title+"</div></div>",t+='<div class="row no-gutter margin-bottom-sm">',t+='<div class="hidden-xs col-sm-2">'+controlData[x].title+"</div>",t+='<div class="hidden-xs col-sm-'+a+'">Name</div>',t+='<div class="col-xs-7 col-sm-2">Sizes</div>',t+='<div class="col-xs-3 col-sm-1 text-center">Q<span class="hidden-xs">uanti</span>ty</div>',controlData[x].prices.listprice&&(t+='<div class="hidden-xs col-sm-1 text-center">',t+=controlData[x].prices.listprice,t+="</div>"),controlData[x].prices)"listprice"!=s&&("1"==s?(t+='<div class="col-xs-2 col-sm-1 text-center nobr">',t+=controlData[x].prices[s],t+="</div>"):(t+='<div class="hidden-xs col-sm-1 text-center nobr">',t+=controlData[x].prices[s],t+="</div>"));t+="</div>";var r=0,o=0;for(o=0;o<Object.keys(controlData[x].variants).length&&r<=300;o++){for(;!controlData[x].variants[r]&&r<=299;)r++;var l=!!controlData[x].variants[r].unavailable;t+=new customOrderformVariant(controlData[x].variants[r].textval,l,controlData[x].variants[r].vcode,controlData[x].variants[r].sizes,controlData[x].prices,a).createTableRow(),r++}}if($("#orderform").html(t),$(".input-quant").keyup(function(){var e=!1;$(".input-quant").each(function(){$(this).val()&&$(this).val()>0&&(e=!0)}),e?$(".mobile-cart").addClass("show-mobile-cart"):$(".mobile-cart").removeClass("show-mobile-cart")}),navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i))return!1}function createCustomOrderformProductData(e){variantData=e,$('select[name^="stocknum"]').each(function(){var e=$(this).data("vcode"),t=$(this).val();for(x in variantData)for(y in variantData[x].variants){if(variantData[x].variants[y].vcode==e){var i='<div class="stockinfo font-size-sm';variantData[x].variants[y].stocknum==t?i+='"':i+=' invis"',"deleted"==variantData[x].variants[y].stockstatus||"outofstock"==variantData[x].variants[y].stockstatus?(i+=' id="stockstatus-'+variantData[x].variants[y].stocknum+"-"+variantData[x].variants[y].vcode+'">',i+=variantData[x].variants[y].child_title,i+=" - Sorry, this item is temporarily sold out.",variantData[x].variants[y].stockinfo&&(i+="<br />",i+=variantData[x].variants[y].stockinfo)):"specialorder"==variantData[x].variants[y].stockstatus?(i+=' id="stockstatus-'+variantData[x].variants[y].stocknum+"-"+variantData[x].variants[y].vcode+'">',i+=variantData[x].variants[y].child_title,i+=' is a <a class="fancybox" href="/popup/specialorder.html">special order item</a> (call for details)',variantData[x].variants[y].stockinfo&&(i+="<br />",i+=variantData[x].variants[y].stockinfo)):"dropship"==variantData[x].variants[y].stockstatus?(i+=' id="stockstatus-'+variantData[x].variants[y].stocknum+"-"+variantData[x].variants[y].vcode+'">',i+=variantData[x].variants[y].child_title,i+=' is a <a class="fancybox" href="/popup/dropship.html">dropship item</a>',variantData[x].variants[y].stockinfo&&(i+="<br />",i+=variantData[x].variants[y].stockinfo)):(i+=' id="stockstatus-'+variantData[x].variants[y].stocknum+"-"+variantData[x].variants[y].vcode+'">',variantData[x].variants[y].stockinfo&&(i+=variantData[x].variants[y].child_title,i+=" - ",i+=variantData[x].variants[y].stockinfo)),i+="</div>",$('div[name="colorname-'+e+'"]').append(i)}if(variantData[x].variants[y].vcode==e&&variantData[x].variants[y].stocknum==t)for(z in $("#color-chip-"+e).css("backgroundColor",variantData[x].variants[y].colorsample_rgb),variantData[x].variants[y].listprice&&$('div[name="price-'+e+'-listprice"]').html("$"+variantData[x].variants[y].listprice),variantData[x].variants[y].prices)variantData[x].variants[y].prices[z]?$('div[name="price-'+e+"-"+z+'"]').html("$"+variantData[x].variants[y].prices[z]):$('div[name="price-'+e+"-"+z+'"]').html("N/A"),$('div[name="price-'+e+"-"+z+'"]').css("color","#222222")}}),$("select.sizepulldown").one("focus",function(){var e=$(this);e.data("previous",e.val())}).on("change",function(){var e=$(this);e.data("vcode",e.data("data-vcode")),e.data("stocknum",e.val()),alterPrices(e.data("vcode"),e.data("stocknum"),e.data("previous")),e.data("previous",e.val())}),$(".fancybox").fancybox({iframe:{scrolling:"yes",preload:!0},helpers:{title:{type:"inside"}}})}function alterPrices(e,t,i){for(x in $("#stockstatus-"+i+"-"+e).hide(),$("#stockstatus-"+t+"-"+e).fadeIn(),$('div[name^="price-'+e+'-"]').html(""),variantData)for(y in variantData[x].variants)if(variantData[x].variants[y].vcode==e&&variantData[x].variants[y].stocknum==t)for(z in variantData[x].variants[y].listprice&&$('div[name="price-'+e+'-listprice"]').html("$"+variantData[x].variants[y].listprice),variantData[x].variants[y].prices)variantData[x].variants[y].prices[z]?$('div[name="price-'+e+"-"+z+'"]').html("$"+variantData[x].variants[y].prices[z]):$('div[name="price-'+e+"-"+z+'"]').html("N/A")}function calcTime(e,t){var i=new Date;return t=parseInt(t)+1,utc=i.getTime()+6e4*i.getTimezoneOffset(),nd=new Date(utc+36e5*t),nd}function timeleft(){var e=0,t=calcTime("Pacific Standard Time",-8),i="",a=parseInt(t.getFullYear()),n=parseInt(t.getMonth()),s=parseInt(t.getDay()),r=parseInt(t.getHours());s>0&&s<6&&r<11?(i=" today.",s=parseInt(t.getDate())):s>0&&s<5&&r>=11?(i=" tomorrow.",s=parseInt(t.getDate())+1):5==s&&r>=11?(i=" on Monday.",s=parseInt(t.getDate())+3):0==s||6==s?(i=" on Monday.",0==s?s=parseInt(t.getDate())+1:6==s&&(s=parseInt(t.getDate())+2)):e=0,r=11;var o=" and we'll ship "+i+"</div>",l=(new Date(a,n,s,r,0,0),new Date),c=0-l.getSeconds(),d=0-l.getMinutes(),u=r-l.getHours(),p=s-l.getDate(),m=n-l.getMonth();l.getFullYear(),new Date(l.getFullYear(),l.getMonth(),32).getDate();c<0&&(c=(c+60)%60,d--),d<0&&(d=(d+60)%60,u--),u<0&&(u=(u+24)%24,p--),p<0&&(p=0,m--),m<0&&(m=0);var g=1==c?" second ":" seconds ",h=1==d?" minute ":" minutes ",v=1==u?" hour, ":" hours, ",f=1==p?" day, ":" days, ";if(0==e)return!1;var b='<div class="bold">Order in the next ',w=document.getElementById("shipTimeMsg");p>0&&(b+='<span style="color:#ff820d;">'+p+f+"</span>"),u>0&&(b+='<span style="color:#ff820d;">'+u+v+"</span>"),d>0&&(b+='<span style="color:#ff820d;">'+d+h+"</span>"),0==p&&0==u&&0==d&&(b+='<span style="color:#ff820d;">'+c+g+"</span>"),b+=o,w&&(w.innerHTML=b),timerID=setTimeout("timeleft()",1e3)}function returnToShopping(e){document.location.href=e}function goToCheckout(e){var t="__ssl_prefix__://__sitesslserver____sitessldomain__/cgi-bin/checkout.cgi?pg_targ="+e;return window.open(t,"Checkout","resizable=yes,scrollbars=yes,menubar=yes,location=no,status=yes,width=620,height=620").opener=window,!1}function getAll(e){var t;for(t=0;t<e.elements.length;t++)"quant"==e.elements[t].name.substring(0,5)&&(e.elements[t].value="1");return!1}function trashAll(e){var t;if(e.elements)for(t=0;t<e.elements.length;t++)"remove"==e.elements[t].name.substring(0,6)&&(e.elements[t].checked="true");return!1}function getNone(e){var t;for(t=0;t<e.elements.length;t++)"quant"==e.elements[t].name.substring(0,5)&&(e.elements[t].value="");return!1}function itemRow(e,t){this.thumbsrc="/images/eng/products/110/"+e.thumbsrc1,this.title=e.title,this.stocknum=e.stocknum,this.childtitle=null!=e.child_title?e.child_title+" - ":"",this.textval=null!=e.textval?e.textval:"",this.quant=e.quant,this.unitpr=e.unitpr,this.prices=e.prices,this.linetotal=e.linetotal,this.vcode=e.vcode,this.discount="1"!=e.unitct?'<span class="discountbadge"><span class="attn">'+e.unitct+"+</span> Discount</span>":"",this.color=t,this.updateCartAddition=function(e){return e+Number(this.quant)},this.updateCartOOS=function(e){return e+Number(this.quant)},this.getNextDiscLevel=function(e){var t=!1;for(k in this.prices){if(1==t)return t=!1,k;k==e&&(t=!0)}},this.getNumInGroup=function(e,t){var i=0;for(k in t)t[k].stocknum==e&&(i+=Number(t[k].quant));return i},this.createLineDisplay=function(e){var t='<img class="left productimg" src="'+this.thumbsrc+'" alt="'+this.title+'" />';return t+='<div class="title" style="color: '+this.color+';">'+this.title+"</div>",t+='<div class="details" style="color: '+this.color+';">'+this.childtitle+this.textval+"</div>",e&&(t+='<div class="details" style="color: '+this.color+';">'+this.quant+" @ $"+this.unitpr+" each "+this.discount+"</div>"),t+='<div class="thin_separator" style="">&nbsp;</div>'}}function relateditem(e){this.title=e.title,this.objid=e.objid,this.thumbsrc=e.thumbsrc1,this.numratings=e.num_ratings>0?e.num_ratings:0,this.avgrating=e.num_ratings>0?e.avg_rating:0,this.stars=e.num_ratings>0?(Math.round(2*this.avgrating)/2).toFixed(1).toString().replace(".","-"):"",this.prices=e.prices,this.maxdiscount=Object.keys(this.prices).sort().pop(),this.price=this.prices[this.maxdiscount],this.createProduct=function(){var e='<div class="relatedimage"><a href="/html/eng/'+this.objid+'.shtml">';return e+='<img src="'+imageserver+"/images/eng/products/110/"+this.thumbsrc+'" alt="'+this.title+'"></a></div>',e+='<div class="relatedtitle"><a class="s_link" href="/html/eng/'+this.objid+'.shtml">'+this.title+"</a></div>",this.numratings>0&&(e+='<div class="starrating"><img src="'+imageserver+"/images/public/ratings_stars/stars-",e+=this.stars,e+='.gif" align="absmiddle" alt="'+this.stars+' star rating" />&nbsp;<span class="avgrating">',e+=this.avgrating,e+='</span></div><div class="numratings"><a class="s_link" href="/html/eng/',e+=this.objid,e+='.shtml#reviews">',e+=this.numratings,e+="&nbsp;review",e+=pluralize(this.numratings),e+="</a></div>"),this.price&&(e+='<div class="lowprice">As low as $',e+=this.price,e+="</div>"),e}}function checkFormErrors(){var e=!0;if($('input[name^="quant"]').each(function(t){""!=$(this).val()&&(e=!1)}),1==e){var t=$('<div id="MenuDialog" title="<h4>There\'s just one little problem...</h4>"><p><b>How much or many do you want? You must enter a quantity before we can add the item(s) to your cart.</b></p></div>');return $.fancybox(t,{maxWidth:450,scrolling:!1,fitToView:!1,autoSize:!0,closeBtn:!0,helpers:{title:{type:"outside",position:"top"}},afterClose:function(){clearOverlay()}}),!1}return e}function submitCart(e){var t=checkFormErrors(),i=!0;findBootstrapEnvironment();return USE_INLINE_SHOPPING_CART=!0,!t&&(!t&&USE_INLINE_SHOPPING_CART&&(processOrderForms(e),i=!1),$("input").blur(),i)}function processOrderForms(e){var t="/cgi-bin/webcart.cgi",i=$(e).serialize();i+="&interface=json",displayCartSpinner(),$.ajax({type:"POST",url:t,data:i,success:createCartOverlay,error:function(){window.location=t+"?"+$(e).serialize()+"&inlinefail=1"}})}function createCartOverlay(e){var t=e.new_rows?e.new_rows:[],a=e.existing_rows?e.existing_rows:[],n=e.noa_rows?e.noa_rows:[],s=e.orderlines?e.orderlines:[],r=e.related_items?e.related_items:[],o=0,l=0,c=0,d=0,u=0,p="",m=!1,g="",h="";if(r.length>0){var v=680,f=Math.ceil(r.length/4);$(".promotional").css("display","block").attr("data-promopages",f).html('<div id="relprotitle" class="title">Some items you may be interested in:</div><div class="left nav" onClick="iterateRelatedProducts(-1);"><img id="rpitleft" class="invis" src="'+imageserver+'/images/eng/general/left_blue_10x60.png" alt="More Items" /></div>'),$(".promotional").attr("rel")||$(".promotional").attr("rel","0"),createRelatedProducts(r)}else v=400;if(t.length>0)for(i in m=t[0].unitct,t){var b=new itemRow(t[i],"#222222");g=""==g?t[i].discountgroup:g,d=b.updateCartAddition(d),h+=b.createLineDisplay(1),p=b.getNextDiscLevel(m),c=""==c?b.getNumInGroup(t[0].stocknum,s):c}if(a.length>0)for(i in m=0==m?a[0].unitct:m,h+=separateLineItems("Items already in your cart have been adjusted","#888888","290"),a){b=new itemRow(a[i],"#888888");g=""==g?a[i].discountgroup:g,d=b.updateCartAddition(d),h+=b.createLineDisplay(1),p=b.getNextDiscLevel(m),c=""==c?b.getNumInGroup(a[0].stocknum,s):c}if(n.length>0){var w=getCookie("userclass")&&""!=getCookie("userclass")?"Out Of Stock items added to your Notify On Arrival list":'Out Of Stock items could not be added (<a href="/cgi-bin/myaccount.cgi?mode=login">Sign In</a>)';for(i in h+=separateLineItems(w,"#a7101f","340"),n){u=(b=new itemRow(n[i],"#a7101f")).updateCartOOS(u),h+=b.createLineDisplay(0)}$("#numItemsOOS").html(u),$("#OOSitemS").html(pluralize(u)),$("#alertOOSItems").css("display","inline")}for(i in s){var y=s[i].quant;o+=Number(y),"C"==s[i].discountgroup&&(l+=Number(y))}var x,k=e.st_taxable;if(""!=p)if("C"==g){if((x=Number(p)-Number(l))>0){var _=pluralize(x);$("#nextDiscLvl").html('Add<span class="attn"> '+x+" </span>more clothing item"+_+', receive<span class="attn"> '+p+"+ </span> discount on all"),$("#quantAlert").removeClass("noalert"),$("#quantAlert").addClass("quantalert clothingalert padding-top-sm padding-bottom-sm margin-top-md margin-bottom-md")}}else(x=Number(p)-Number(c))>0&&($("#nextDiscLvl").html('Add<span class="attn"> '+x+' </span>more to receive<span class="attn"> '+p+"+ </span>discount"),$("#quantAlert").removeClass("noalert"),$("#quantAlert").addClass("quantalert genericalert padding-top-sm padding-bottom-sm margin-top-md margin-bottom-md"));$("#productInfo").html(h),$("#numItemsAdded").html(d),$("#itemS").html(pluralize(d)),$("#numItemsInCart").html(o),$("#itemIC").html(pluralize(o)),$("#orderSubtotal").html(k.toFixed(2)),displayCartUpdate(v)}function separateLineItems(e,t,i){var a='<div style="font: normal normal 14px/18px Arial; color: '+t+"; border-bottom: "+("1px solid "+t)+"; width: "+(i+"px")+';">'+e+"</div>";return a+='<div class="thin_separator">&nbsp;</div>'}function clearOverlay(){for($("#alertOOSItems").css("display","none"),$("#productInfo").html(""),$("#nextDiscLvl").html("&nbsp;"),$("#quantAlert").removeClass("quantalert clothingalert genericalert").addClass("noalert"),i=0;i<4;i++)$("#relpro"+i).html("")}function displayCartUpdate(e){var t=$("#cartOverlay").html();return $.fancybox(t,{minWidth:"50%",maxWidth:"90%",maxHeight:e,scrolling:!0,fitToView:!1,autoSize:!0,closeBtn:!0,beforeClose:function(){$('input[name^="quant"]').val(""),$('input:checkbox[name^="quant"]').removeAttr("checked"),$('input:checkbox[name^="quant"]').val("1")},afterClose:function(){clearOverlay(),$(".mobile-cart").removeClass("show-mobile-cart")}}),!1}function displayCartSpinner(){var e='<div style="padding: 32px 0px 0px 32px;"><img src="'+imageserver+'/images/public/ajax/ajax-loader-5.gif" alt="AJAX Spinner" border="0" /></div>';return $.fancybox(e,{height:96,width:96,scrolling:!1,fitToView:!1,autoSize:!1,closeBtn:!0}),!1}function createRelatedProducts(e){var t=4*Number($(".promotional").attr("rel")),a=t+3,n=0;for(i in e)if(e[i]&&"47001-A"!=e[i].objtype){var s=new relateditem(e[i]).createProduct(),r=" invis",o=Number(i)+n;o>=t&&o<=a&&(r=""),$(".promotional").append('<div id="relpro'+o+'" class="left promotion'+r+'">'+s+"</div>")}else n--;var l=Math.ceil((e.length+n)/4);$(".promotional").attr("data-promopages",l),$(".promotional").append('<div class="left nav" onClick="iterateRelatedProducts(1);"><img id="rpitright" class="invis" src="'+imageserver+'/images/eng/general/right_blue_10x60.png" alt="Itterate Right" /></div>'),l>1&&$("#rpitright").removeClass("invis")}function iterateRelatedProducts(e){var t=Number($(".promotional").attr("rel"))+e,a=4*t,n=a+3;for(t>0?$("#overlayContainer .promotional #rpitleft").removeClass("invis"):$("#overlayContainer .promotional #rpitleft").addClass("invis"),t+1<Number($(".promotional").attr("data-promopages"))?$("#overlayContainer .promotional #rpitright").removeClass("invis"):$("#overlayContainer .promotional #rpitright").addClass("invis"),$(".promotional").attr("rel",t),$("#overlayContainer .promotional .promotion").addClass("invis"),i=a;i<=n;i++)$("#overlayContainer .promotional #relpro"+i).removeClass("invis");return!1}timeleft();